---
layout: post
title: JVM 基本结构
category: ['JVM']
tags: ['JVM']
author: 景阳
email: jingyang@asiainfo.com
description: 介绍JVM 基本结构
---

## 一、虚拟机的基本结构
Java 虚拟机的基本结构如图：

![jvm.png](/assets/img/jvm.png)

**绿色代表所有线程共享区域，黄色代表每个线程的私有区域**

### 1、方法区：或者叫`永久代`，包括类信息和运行时常量信息等。
* 类信息：从文件或网络系统中加载的 class 信息。
* 运行时常量池：包括字符串字面量、数字常量。
  - 整数类型会提前缓存`[-128，127]`之间的数字。
  - String的`intern()`方法会去常量池找相同的字符串并返回。
* 静态变量、即时编译器编译后的代码。
### 2、Java 堆：是 Java 最主要的内存工作区域，几乎所有的`对象实例`及`数组`都在堆上分配。
### 3、Java 栈：是线程私有的。描述的是`Java 方法` 执行的内存模型，保存着局部变量表、操作数栈、帧数据区等信息。
### 4、本地方法栈：为 `Native 方法`的执行服务。
### 5、程序计数器：主要代表`当前线程`所执行的`字节码行号指示器`。字节码解释器工作时，通过改变这个计数器的值来选取`下一条`需要执行的`字节码指令`。

## 二、Java 栈
Java 栈是一块`先进后出`的数据结构，方法只有`入栈`和`出栈`。

它所操作的对象是`栈帧`。每个方法执行的时候都会创建一个`栈帧`，它保存着局部变量表、操作数栈、帧数据区等信息。

当方法被调用时，它对应的栈帧就会入栈，当方法返回时，栈帧就会出栈。

![stack.png](/assets/img/stack.png)

## 三、Java 堆
