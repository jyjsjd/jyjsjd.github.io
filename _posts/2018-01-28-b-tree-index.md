---
layout: post
title: MySQL 索引
category: ['Java']
tags: ['Java']
author: 景阳
email: jyjsjd@hotmail.com
description: MySQL 索引
---

#### 索引的选择性
`索引的选择性`是**不重复**的索引值和数据表的记录**总数**（n）的比值，范围在 `1/n` 到 `1` 之间。选择性越高查询效率也越高，因为选择性高的索引可以在查询时过滤掉更多的行。`唯一索引`的选择性是 1，所以性能也是最好的。

如何选择索引的列顺序至关重要，有一个经验法则：将选择性高的列放在索引的**最前面**。

#### 聚簇索引
聚簇索引不是一种单独的索引类型，而是一种数据的*存储方式*。

当表有聚簇索引时，它的数据行存放在索引的**叶子页**中。聚簇表示数据行和相邻的键值紧凑地储存在一起。由于无法同时把数据行存放在两个不同的地方，所以一个表只能有**一个**聚簇索引。

InnoDB 通过*主键*聚集数据。

#### 二级索引
二级索引指的是非聚簇索引。
* 二级索引的叶子节点中包含了引用行的**主键列**。
* 二级索引需要**两次**索引查找。因为二级索引保存的不是指向行的物理位置的指针，而是行的主键值。

![secondary.png](/assets/img/secondary.png)

#### 覆盖索引
覆盖索引：索引包含所有需要**查询**的字段的值。

#### 索引扫描排序
* 索引的**列顺序**和 ORDER BY 子句的顺序完全一致；
* 并且所有列的**排序方向**都一样时，才能使用索引对结果排序；
* 除非索引第一列为**常数**，但是剩余的列也必须*顺序一致*。

#### B-Tree 索引匹配
B-Tree 索引对以下查询有效（列顺序符合**最左匹配**）：
* 全值匹配：和索引的所有列进行匹配。
* 匹配最左前缀
* 匹配范围值
* 精确匹配某一列，并范围匹配另一列

限制：
* 如果不是从索引的**最左列**开始查找，无法使用索引。
* 不能跳过索引中的列。
* 如果查询中有某个列的*范围查询*，则其**右边**的所有列都无法使用索引优化查找。
